---
layout: post
title: Generate all possible proteins from ambiguous DNA
date: '2011-01-19T16:00:00.000-08:00'
author: Mark Evans
tags:
- BioPython
- bioinformatics
- python
modified_time: '2011-01-19T16:50:16.526-08:00'
blogger_id: tag:blogger.com,1999:blog-8042776731714569314.post-7992413286018545949
blogger_orig_url: http://codexpython.blogspot.com/2011/01/generate-all-possible-proteins-from.html
---

This had me stumped for awhile, but this works pretty well. &nbsp;Does NOT handle stop codons or gap characters like '-'. &nbsp;Requires BioPython<br /><br /><span class="Apple-style-span" style="color: #404040; font-family: Arial, Tahoma, Helvetica, FreeSans, sans-serif; font-size: 13px; line-height: 18px;"></span><br /><pre class="prettyprint" style="background-attachment: initial; background-clip: initial; background-color: #eeeeee; background-image: initial; background-origin: initial; border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif; font-size: 14px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; margin-top: 0px; max-height: 600px; overflow-x: auto; overflow-y: auto; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; padding-top: 5px; vertical-align: baseline; width: auto;"><span class="Apple-style-span" style="color: darkblue;"><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;"><b><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">import itertools</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">from Bio.Seq import Seq</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">from Bio.Data import CodonTable</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">from Bio.Data import IUPACData&lt;/pre&gt;</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;"><br /></span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;"># Takes Bio.Seq.Seq object as input</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;"># Returns list of all possible proteins</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;"># Assumes sequence is in frame +1</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">def generateProtFromAmbiguousDNA(s):</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; std_nt = CodonTable.unambiguous_dna_by_name["Standard"]</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; nonstd = IUPACData.ambiguous_dna_values</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; aa_trans = []</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; for i in range(0,len(s),3):</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; &nbsp; &nbsp;codon = s.tostring()[i:i+3]</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; &nbsp; &nbsp;aa = CodonTable.list_possible_proteins(codon,std_nt.forward_table,nonstd)&nbsp;</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; &nbsp; &nbsp;aa_trans.append(aa)</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; proteins = list(itertools.product(*aa_trans))</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; possible_proteins = []</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; for x in proteins:</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; &nbsp; &nbsp;possible_proteins.append("".join(x))</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; return possible_proteins</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;"><br /></span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">def main():</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; a = Seq('ATGGCARTTGTAHAC')</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; print "DNA: ",a.tostring()</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; print "Proteins:"</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; foo = generateProtFromAmbiguousDNA(a)</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; for s in foo: print s</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;"><br /></span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">if __name__ == '__main__':</span></div><div style="color: black; line-height: normal; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; white-space: normal;"><span class="Apple-style-span" style="font-size: small;">&nbsp;&nbsp; main()</span></div></b></span></span></div></span></pre>